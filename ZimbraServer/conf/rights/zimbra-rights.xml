<?xml version="1.0" encoding="UTF-8"?>

<!-- 

<right name="{name}"
       [userRight="{user-right}"]
       [type="{right-type}"]
       [targetType="{target-type}"]
       
       
    <desc>a brief description, this is to be displayed by the zmmailbox listPermission command</desc>
       
    [<doc>
         a more detailed description, may include use cases, examples, etc. 
         This is to be displayed by the zmmailbox listPermission command in verbose mode.
     </doc>]
       
    [<default>TRUE/FALSE</default>]
    
    [
      <attrs>
          <a n="{attribute-name}"/>+
      </attrs>
    ]
    
    [
      <rights>
          <r n="{right-name}"/>+
      </rights>
    ]
    
    
</right>

{name}: 
    name of the right

{user-right}: 
    Whether the right is grantable by users
	1: the right is grantable by user
	0(default): the right is only grantable by admins
           
{right-type}: 
    Only applicable and required for admin rights(i.e. userRight="0" or not set)  
	preset      : rights with predefined capabilities     
	getAttrs    : rights for reading attributes
	setAttrs    : rights for reading and writing attributes
	combo       : combo right containing other defined preset/getAttrs/setAttrs/combo rights
      

{target-type}:
    Target type on which the right is applicable.
    1. For preset rights (i.e. type="preset"):
           Required and can have only one value.
    
    2. For getAttrs/setAttrs rights:
           (A) if <attrs> is not present, it means all attributes on the target type.
               {target-type} must contain exactly one target type.   
            
           (B) if <attrs> is present, {target-type} is optional and can have multiple 
               values separated by comma.
           
	           e.g. If a get/setAttrs right has:
	                    account/cos attrs A, B, C
		                domain attrs X, Y, Z
		                server attrs M, N
		                account/cos/domain/server attrs P, Q
	           
			   - If <targetType> is set:
			         The right is only effective when granted on one of the specified entry types.
			         e.g.
			         - if <targetType> contains "account" only, then the right is effective 
			           only for account attributes A, B, C, P, Q, not cos atributes A, B, C, P, Q.
	
			         -  if <targetType> contains "account,cos,server" then the right is effective 
			            for: account attrs A, B, C, P, Q
			                 cos attrs A, B, C, P, Q
			                 server attrs P, Q
	  
	           - If <targetType> is omitted:
	                 It means the right is not affiliated with a particular target type and is 
	                 applicable to all target types.  
    
    3. For combo rights:
           Not allowed.
           
<attrs>:
    Attributes covered by the right.
    It can contain any attrs from any type of entries.
    e.g.  account attrs A, B, C
          domain attrs X, Y, Z
          server attrs M, N
          
    If <attrs> is not present, it means all attributes on the target type.


{attribute-name}:
    Attribute name covered by the right
    
<rights>:    

<rights>
    Rights covered by this combo right.
    Rights appear in <r n=""> must be defined before this right.
    
-->

<rights>
    
<!-- 
*******************
    user rights
*******************
-->

<right name="invite" userRight="1">
  <desc>automatically add meeting invites from grantee to the target's calendar</desc>
  <doc>e.g. (1) When user Y is invited to a meeting, an appt is added to his calendar automatically(tentatively) only if invite is from A, B, C or anyone in group G.
            (2) Conf room Y can only be booked by users A, B, C and group G.
  </doc>
</right>

<right name="loginAs" userRight="1">
  <desc>login as</desc>
  <doc>login as another user.  Currently this is only honored for imap/pop3 login</doc>
</right>

<right name="sendAs" userRight="1">
  <desc>send as</desc>
  <doc>reply to messages in a shared folder as the owner of the folder</doc>
</right>

<right name="viewFreeBusy" userRight="1">
  <desc>view free/busy</desc>
  <doc>e.g. Free/busy for Y can only be seen by users A, B, C and group G.</doc>
</right>


<!-- 
********************
    admin rights
********************
-->

<!-- 
========================================================
                      account rights
========================================================
-->

<right name="getAccount" type="getAttrs" targetType="account">
  <desc>get all account attributes</desc>
</right>

<right name="modifyAccount" type="setAttrs" targetType="account">
  <desc>modify all account attributes</desc>
</right>

<right name="listAccount" type="preset" targetType="account">
  <desc>see account in GetAllAccounts/SearchDirectoryResponse</desc>
</right>

<right name="renameAccount" type="preset" targetType="account">
  <desc>rename account</desc>
</right>

<right name="deleteAccount" type="preset" targetType="account">
  <desc>delete account</desc>
</right>

<right name="addAccountAlias" type="preset" targetType="account">
  <desc>add account alias</desc>
</right>

<right name="removeAccountAlias" type="preset" targetType="account">
  <desc>remove account alias</desc>
</right>

<right name="getAccountInfo" type="preset" targetType="account">
  <desc>get account id, home server, cos id and name, and access URL</desc>
</right>

<right name="getAccountMembership" type="preset" targetType="account">
  <desc>get all groups the account is a member of</desc>
</right>

<right name="adminLoginAs" type="preset" targetType="account">
  <desc>login as the user as an admin.
        This is different from the loginAs user right as follows:
            - loginAs is effective only when logged in as an user
            - adminLoginAs is effective only when logged in as an admin
        
        That is:
            If you are an admin and has the adminLoginAs right on user1,
            the adminLoginAs is effective only when you login as an admin.
            It is not effective if you login as a regular user.
            
            Likewise if another user granted you the loginAs right, the 
            right is effective when you logged in as a regular user, it is 
            not effective when you logged in as an admin.
  </desc>
</right>

<right name="checkRight" type="preset" targetType="account">
  <desc>check if the account has a specific right</desc>
</right> 

<right name="getMailboxInfo" type="preset" targetType="account">
  <desc>get mailbox id and size(quota) of an account</desc>
</right>

<right name="purgeMessages" type="preset" targetType="account">
  <desc>purge messages of an account</desc>
</right>

<right name="reindexMailbox" type="preset" targetType="account">
  <desc>reindex mailbox</desc>
</right> 

<right name="purgeAccountCalendarCache" type="preset" targetType="account">
  <desc>purge account calendar cache</desc>
</right>   

<right name="publishAccountShareInfo" type="preset" targetType="account">
  <desc>publish share info on account</desc>
</right>  

<right name="getAccountShareInfo" type="preset" targetType="account">
  <desc>get share info on account</desc>
</right>         

<!--
    TODO:      
          - getMailboxDump                     : get mailbox dump for legal intercept
          - moveMailbox                        : move mailbox from one server to another
          - reindexMailbox                     : reindex mailbox
          - viewEmail                          : view the account's email
          
          - backupAccount                      : backup account
          - restoreAccount                     : restore account from backup
-->
 
<right name="setAccountPassword" type="preset" targetType="account">
  <desc>set account password</desc>
</right>

<right name="viewPasswordStrength" type="getAttrs" targetType="account,calresource,cos">
  <desc>view password strength</desc>
  <attrs>
      <a n="zimbraPasswordMinLength"/>
      <a n="zimbraPasswordMaxLength"/>
      <a n="zimbraPasswordMinUpperCaseChars"/>
      <a n="zimbraPasswordMinLowerCaseChars"/>
      <a n="zimbraPasswordMinNumericChars"/>
      <a n="zimbraPasswordMinPunctuationChars"/>
  </attrs>
</right>

<right name="configurePasswordStrength" type="setAttrs" targetType="account,calresource,cos">
  <desc>configure password strength</desc>
  <attrs>
      <a n="zimbraPasswordMinLength"/>
      <a n="zimbraPasswordMaxLength"/>
      <a n="zimbraPasswordMinUpperCaseChars"/>
      <a n="zimbraPasswordMinLowerCaseChars"/>
      <a n="zimbraPasswordMinNumericChars"/>
      <a n="zimbraPasswordMinPunctuationChars"/>
  </attrs>
</right>

<right name="viewAdminSavedSearch" type="getAttrs" targetType="account,calresource">
  <desc>view admin saved searches</desc>
  <attrs>
      <a n="zimbraAdminSavedSearches"/>
  </attrs>
</right>

<right name="setAdminSavedSearch" type="setAttrs" targetType="account,calresource">
  <desc>save admin saved searches</desc>
  <attrs>
      <a n="zimbraAdminSavedSearches"/>
  </attrs>
</right>   
          
<right name="configureQuota" type="setAttrs" targetType="account,cos">
  <desc>configure quota</desc>
  <attrs>
      <a n="zimbraMailQuota"/>
      <a n="zimbraQuotaWarnPercent"/>
      <a n="zimbraQuotaWarnInterval"/>
      <a n="zimbraQuotaWarnMessage"/>
  </attrs>
</right>




<right name="configureAdminUI" type="setAttrs" targetType="account">
  <desc>configure admin UI</desc>
  <attrs>
    <a n="zimbraAdminConsoleUIComponents"/>
  </attrs>
</right>


          
<!-- 
    TODO:     
          - configureFeature                   : enable/disable features
          - configurePasswordRule              : configure password rules
          - configureLoginPolicy               : configure login/lockout policies
          - configureZimlet                    : configure available zimlets
          - configureTheme                     : configure available themes(skins)

-->


<!-- 
========================================================
                 calendar resource rights
========================================================
-->

<right name="getCalendarResource" type="getAttrs" targetType="calresource">
  <desc>get all calendar resource attributes</desc>
</right>

<right name="modifyCalendarResource" type="setAttrs" targetType="calresource">
  <desc>modify all calendar resource attributes</desc>
</right>

<right name="listCalendarResource" type="preset" targetType="calresource">
  <desc>see calendar resource in GetAllCalendarResources/SearchDirectoryResponse</desc>
</right>

<right name="renameCalendarResource" type="preset" targetType="calresource">
  <desc>rename calendar resource</desc>
</right>

<right name="deleteCalendarResource" type="preset" targetType="calresource">
  <desc>delete calendar resource</desc>
</right>

<right name="addCalendarResourceAlias" type="preset" targetType="calresource">
  <desc>add calendar resource alias</desc>
</right>

<right name="removeCalendarResourceAlias" type="preset" targetType="calresource">
  <desc>remove calendar resource alias</desc>
</right>

<!-- 
   TODO:

          - getMailboxDump                     : get mailbox dump for legal intercept
          - moveMailbox                        : move mailbox from one server to another
          - reindexMailbox                     : reindex mailbox
          - viewEmail                          : view the calendar resource's email
          
          - backupCalenceResource              : backup calendar resource
          - restoreCalenceResource             : restore calendar resource from backup
-->
       
<right name="setCalendarResourcePassword" type="preset" targetType="calresource">
  <desc>set calendar resource password</desc>
</right>     

<right name="purgeCalendarResourceCalendarCache" type="preset" targetType="calresource">
  <desc>purge calendar resource calendar cache</desc>
</right>

<right name="publishCalendarResourceShareInfo" type="preset" targetType="calresource">
  <desc>publish share info on calendar resource</desc>
</right>

<right name="getCalendarResourceShareInfo" type="preset" targetType="calresource">
  <desc>get share info on distribution list</desc>
</right>

<!-- 
========================================================
                      COS rights
========================================================
-->

<right name="getCos" type="getAttrs" targetType="cos">
  <desc>get all cos attributes</desc>
</right>

<right name="modifyCos" type="setAttrs" targetType="cos">
  <desc>set all cos attributes</desc>
</right>

<right name="listCos" type="preset" targetType="cos">
  <desc>see cos in GetAllCos/SearchDirectoryResponse</desc>
</right>

<right name="renameCos" type="preset" targetType="cos">
  <desc>rename cos</desc>
</right>

<right name="deleteCos" type="preset" targetType="cos">
  <desc>delete cos</desc>
</right>

<right name="assignCos" type="preset" targetType="cos">
  <desc>assign the cos (to domains or accounts)</desc>
</right>

<right name="manageZimlet" type="preset" targetType="cos">
  <desc>activate/deactivate zimlets on a cos</desc>
</right>

<right name="configureCosConstraint" type="setAttrs" targetType="cos">
  <desc>configure cos constraint</desc>
  <attrs>
    <a n="zimbraConstraint"/>
  </attrs>
</right>

<!-- 
  TODO:         
          - configureQuota                     : configure quota
          - configureFeature                   : enable/disable features
          - configurePasswordRule              : configure password rules
          - configureLoginPolicy               : configure login/lockout policies
          - configureZimlet                    : configure available zimlets
          - configureTheme                     : configure available themes(skins)
-->


<!-- 
========================================================
                      config rights
========================================================
-->

<right name="getGlobalConfig" type="getAttrs" targetType="config">
  <desc>get all global config attributes</desc>
</right>

<right name="modifyGlobalConfig" type="setAttrs" targetType="config">
  <desc>modify all global config attributes</desc>
</right>

<right name="configureGlobalConfigConstraint" type="setAttrs" targetType="config">
  <desc>configure global config constraint</desc>
  <attrs>
    <a n="zimbraConstraint"/>
  </attrs>
</right>

<!-- 
========================================================
                 distribution list rights
========================================================
-->

<right name="getDistributionList" type="getAttrs" targetType="dl">
  <desc>get all distribution list attributes</desc>
</right>

<right name="modifyDistributionList" type="setAttrs" targetType="dl">
  <desc>set all distribution list attributes</desc>
</right>

<right name="listDistributionList" type="preset" targetType="dl">
  <desc>see distribution list in GetAllCos/SearchDirectoryResponse</desc>
</right>

<right name="renameDistributionList" type="preset" targetType="dl">
  <desc>rename distribution list</desc>
</right>

<right name="deleteDistributionList" type="preset" targetType="dl">
  <desc>delete distribution list</desc>
</right>

<right name="addDistributionListAlias" type="preset" targetType="dl">
  <desc>add distribution list alias</desc>
</right>

<right name="removeDistributionListAlias" type="preset" targetType="dl">
  <desc>remove distribution list alias</desc>
</right>

<right name="getDistributionListMembership" type="preset" targetType="dl">
  <desc>get all groups the distribution list is a member of</desc>
</right>

<right name="addDistributionListMember" type="preset" targetType="dl">
  <desc>add member to distribution list</desc>
</right>

<right name="removeDistributionListMember" type="preset" targetType="dl">
  <desc>remove member from distribution list</desc>
</right>

<right name="publishDistributionListShareInfo" type="preset" targetType="dl">
  <desc>publish share info on distribution list</desc>
</right>

<right name="getDistributionListShareInfo" type="preset" targetType="dl">
  <desc>get share info on distribution list</desc>
</right>

<!-- 
========================================================
                      domain rights
========================================================
-->

<right name="getDomain" type="getAttrs" targetType="domain">
  <desc>get all domain attributes</desc>
</right>

<right name="modifyDomain" type="setAttrs" targetType="domain">
  <desc>set all domain attributes</desc>
</right>

<right name="listDomain" type="preset" targetType="domain">
  <desc>see domain in GetAllCos/SearchDirectoryResponse</desc>
</right>

<right name="deleteDomain" type="preset" targetType="domain">
  <desc>delete domain</desc>
</right>

<right name="createSubDomain" type="preset" targetType="domain">
  <desc>create sub domain</desc>
</right>

<right name="checkDomainMXRecord" type="preset" targetType="domain">
  <desc>check doamin MX record</desc>
</right>

<right name="countAccount" type="preset" targetType="domain">
  <desc>count accounts in a domain</desc>
</right>

<right name="getDomainQuotaUsage" type="preset" targetType="domain">
  <desc>get domain quota usage</desc>
</right>
          
<!--       
  TODO:      
          - crossMailboxSearch                : run search mail (CMBS) functionality
-->   

<right name="createAccount" type="preset" targetType="domain">
  <desc>create account in the domain</desc>
</right>

<right name="createCalendarResource" type="preset" targetType="domain">
  <desc>create calendar resource in the domain</desc>
</right>

<right name="createDistributionList" type="preset" targetType="domain">
  <desc>create distribution list in the domain</desc>
</right>

<right name="createAlias" type="preset" targetType="domain">
  <desc>create alias in this domain</desc>
</right>

<right name="deleteAlias" type="preset" targetType="domain">
  <desc>delete alias in this domain</desc>
</right>

<right name="accessGAL" type="preset" targetType="domain">
  <desc>access GAL by doing AutoCompleteGal/SearchGal/SyncGal requests</desc>
</right>
         
<right name="checkExchangeAuthConfig" type="preset" targetType="domain">
  <desc>check exchange auth config</desc>
</right>

<right name="checkExternalGALConfig" type="preset" targetType="domain">
  <desc>check external GAL config</desc>
</right>

<right name="configureWikiAccount" type="setAttrs" targetType="domain,config">
  <desc>configure attributes for wiki account</desc>
   <attrs>
    <a n="zimbraNotebookAccount"/>                                
  </attrs> 
</right>


<right name="configureExternalGAL" type="setAttrs" targetType="domain">
  <desc>configure attributes for external GAL</desc>
   <attrs>
    <a n="zimbraGalMode"/>
    <a n="zimbraGalLdapURL"/>
    <a n="zimbraGalLdapSearchBase"/>
    <a n="zimbraGalLdapBindDn"/>
    <a n="zimbraGalLdapBindPassword"/>
    <a n="zimbraGalLdapFilter"/>
    <a n="zimbraGalAutoCompleteLdapFilter"/>
    <a n="zimbraGalSyncLdapURL"/>
    <a n="zimbraGalSyncLdapSearchBase"/>
    <a n="zimbraGalSyncLdapFilter"/>
    <a n="zimbraGalSyncLdapAuthMech"/>
    <a n="zimbraGalSyncLdapBindDn"/>
    <a n="zimbraGalSyncLdapBindPassword"/>                                   
  </attrs> 
</right>


<right name="checkExternalAuthConfig" type="preset" targetType="domain">
  <desc>check auth config for external auth</desc>
</right>

<right name="configureExternalAuth" type="setAttrs" targetType="domain">
  <desc>configure attributes for external auth</desc>
   <attrs>
    <a n="zimbraAuthMech"/>
    <a n="zimbraAuthLdapURL"/>
    <a n="zimbraAuthLdapBindDn"/>
    <a n="zimbraAuthLdapSearchBase"/>
    <a n="zimbraAuthLdapSearchFilter"/>
    <a n="zimbraAuthLdapSearchBindDn"/>
    <a n="zimbraAuthLdapSearchBindPassword"/>      
    <a n="zimbraAuthFallbackToLocal"/>
    <a n="zimbraAuthKerberos5Realm"/>
    <a n="zimbraAuthLdapStartTlsEnabled"/>
  </attrs> 
</right>         



    
<!-- 
========================================================
                    server rights
========================================================
-->   

<right name="getServer" type="getAttrs" targetType="server">
  <desc>get all server attributes</desc>
</right>

<right name="modifyServer" type="setAttrs" targetType="server">
  <desc>set all server attributes</desc>
</right>

<right name="listServer" type="preset" targetType="server">
  <desc>see server in GetAllCos/SearchDirectoryResponse</desc>
</right>

<right name="deleteServer" type="preset" targetType="server">
  <desc>delete server</desc>
</right>

<right name="flushCache" type="preset" targetType="server">
  <desc>flush LDAP, skin, local caches on server</desc>
</right>

<right name="checkDirectoryOnFileSystem" type="preset" targetType="server">
  <desc>check and create directory on file system</desc>
</right>

<right name="checkHealth" type="preset" targetType="server">
  <desc>check server health</desc>
</right>
       
<right name="getSessions" type="preset" targetType="server">
  <desc>dump/get sessions</desc>
</right>

<right name="getMailboxStats" type="preset" targetType="server">
  <desc>get mailbox stats homed on the server</desc>
</right>

<right name="manageMailQueue" type="preset" targetType="server">
  <desc>view and take actions on mail queues</desc>
</right>   

<right name="manageAccountLogger" type="preset" targetType="server">
  <desc>add/remove account loggers</desc>
</right>

<right name="manageVolume" type="preset" targetType="server">
  <desc>create, volumes</desc>
</right>  

<right name="manageWaitSet" type="preset" targetType="server">
  <desc>create, destroy, wait, query wait sets</desc>
</right>  

<right name="deployZimlet" type="preset" targetType="server">
  <desc>deploy and undeploy zimlets on a server</desc>
</right> 
       
<!-- 
  TODO:
          - deployAdminExtension             : deploy admin extensions
          - editAdminExtension               : edit admin extensions
          - removeAdminExtension             : remove admin extensions
          
          - manageCertificate                : manage certificates
          - deployZimlets                    : deploy zimlets

          - configureMTA                     : configure MTA
          - configurePOP3                    : configure POP3
          - configureIMAP                    : configure IMAP
          - configurePOPProxy                : configure POP3 proxy
          - configureIMAPProxy               : configure IMAP proxy
          - configureVolumes                 : configure volumes
          - configureServiceEnabled          : configure services enabled
-->

<!-- 
========================================================
                    XMPP component rights
========================================================
--> 

<right name="getXMPPComponent" type="getAttrs" targetType="xmppcomponent">
  <desc>get all XMPP component attributes</desc>
</right>

<right name="modifyXMPPComponent" type="setAttrs" targetType="xmppcomponent">
  <desc>set all XMPP component attributes</desc>
</right>

<right name="listXMPPComponent" type="preset" targetType="xmppcomponent">
  <desc>see XMPP component in GetAllXMPPComponents</desc>
</right>

<right name="deleteXMPPComponent" type="preset" targetType="xmppcomponent">
  <desc>delete XMPP component</desc>
</right>



<!-- 
========================================================
                    zimlet rights
========================================================
--> 

<right name="getZimlet" type="getAttrs" targetType="zimlet">
  <desc>get all zimlet attributes</desc>
</right>

<right name="modifyZimlet" type="setAttrs" targetType="zimlet">
  <desc>set all zimlet attributes</desc>
</right>

<right name="listZimlet" type="preset" targetType="zimlet">
  <desc>see zimlet in GetAllZimlets</desc>
</right>

<right name="deleteZimlet" type="preset" targetType="zimlet">
  <desc>delete zimlet</desc>
</right>


<!-- 
========================================================
                    global grant rights
========================================================
-->

<right name="createCos" type="preset" targetType="global">
  <desc>create cos</desc>
</right>

<right name="createServer" type="preset" targetType="global">
  <desc>create server</desc>
</right>

<right name="createTopDomain" type="preset" targetType="global">
  <desc>create a top-level domain</desc>
</right>

<right name="createXMPPComponent" type="preset" targetType="global">
  <desc>create XMPP component</desc>
</right>

<right name="createZimlet" type="preset" targetType="global">
  <desc>create zimlet</desc>
</right>


<!-- 
========================================================
                    misc rights
========================================================
-->

<right name="viewGrants" type="getAttrs" targetType="account,calresource,cos,dl,domain,server,xmppcomponent,zimlet,config,global">
  <desc>view grants on all target types</desc>
  <doc>
	  Use just the one same right on all target types for now.
	     
	   e.g. If this right is granted on a domain, the grantee 
	        can see zimbraACE on the domain, all DLs, and all 
	        accounts in the domain.
	        
	        To do things like:
	        "can see grants granted on all accounts in the domain
	         but cannot see any grants on the domain entry itself"
	        
	        grant an inline right on the domain entry, like:
	            get:account:zimbraACE
	        and do not grant this right.
	        
	        This right the equivalent of the sum of the following inline
	        rights:
	            get.account.zimbraACE
	            get.calresource.zimbraACE
	            get.cos.zimbraACE
	            get.dl.zimbraACE
	            get.domain.zimbraACE
	            get.server.zimbraACE
	            get.xmppcomponent.zimbraACE
	            get.zimlet.zimbraACE
	            get.config.zimbraACE
	            get.global.zimbraACE
  </doc>
  <attrs>
      <a n="zimbraACE"/>
  </attrs>
</right>

      
</rights>