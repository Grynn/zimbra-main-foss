--- openldap-2.4.16/servers/slapd/back-bdb/dn2id.c	26 Jan 2009 09:20:51 -0000	1.163
+++ openldap-2.4.16/servers/slapd/back-bdb/dn2id.c	1 May 2009 02:26:44 -0000	1.164
@@ -529,8 +529,8 @@ int hdb_fix_dn(
 		}
 	}
 	BEI(e)->bei_modrdns = max;
-	ptr[-1] = '\0';
-	nptr[-1] = '\0';
+	if ( ptr > e->e_name.bv_val ) ptr[-1] = '\0';
+	if ( nptr > e->e_nname.bv_val ) nptr[-1] = '\0';
 
 	return 0;
 }
