---  openldap-2.4.20/servers/slapd/connection.c	21 Nov 2009 20:44:45 -0000	1.448
+++  openldap-2.4.20/servers/slapd/connection.c	4 Dec 2009 01:44:00 -0000	1.449
@@ -1362,8 +1362,8 @@ connection_read( ber_socket_t s, conn_re
 			    c->c_connid, (int) s, c->c_tls_ssf, c->c_ssf, 0 );
 			slap_sasl_external( c, c->c_tls_ssf, &authid );
 			if ( authid.bv_val ) free( authid.bv_val );
-		} else if ( rc == 1 ) {	/* need to retry */
-			slapd_set_read( s, 0 );
+		} else if ( rc == 1 && ber_sockbuf_ctrl( c->c_sb,
+			LBER_SB_OPT_NEEDS_WRITE, NULL )) {	/* need to retry */
 			slapd_set_write( s, 1 );
 			connection_return( c );
 			return 0;
