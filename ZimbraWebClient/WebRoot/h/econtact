<%@ page buffer="8kb" autoFlush="true" %>
<%@ page pageEncoding="UTF-8" contentType="text/html; charset=UTF-8" %>
<%@ taglib prefix="zm" uri="com.zimbra.zm" %>
<%@ taglib prefix="app" uri="com.zimbra.htmlclient" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt" %>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<fmt:setBundle basename="/msgs/ZhMsg" scope="session"/>
<app:handleError>
    <zm:computeSearchContext var="context" types="contact" usecache="true"/>
    <c:set var="isCreate" value="${empty param.id}"/>

    <c:choose>
        <c:when test="${isCreate}">
            <c:set var="contact" value="${null}"/>
            <fmt:message var="title" key="newContact"/>
        </c:when>
        <c:otherwise>
            <zm:getContact id="${param.id}" var="contact"/>
            <fmt:message var="title" key="editContact">
                <fmt:param>${contact.displayFileAs}</fmt:param>
            </fmt:message>
        </c:otherwise>
    </c:choose>
</app:handleError>

<app:head title="${title}"/>

<body>
<app:view context="${context}" selected="contacts" contacts="true" tags="true" keys="false">
    <zm:currentResultUrl var="currentUrl" disp="${isCreate ? 0 : 1}" value="" action="${param.action}" context="${context}"/>
    <form action="${currentUrl}" method="post">
        <table width=100% cellpadding="0" cellspacing="0">
            <tr>
                <td class='TbTop'>
                    <app:editContactToolbar create="${isCreate}"context="${context}" keys="true"/>
                </td>
            </tr>
            <tr>
                <td class='ZhAppContent'>
                        <app:editContact title="${title}" contact="${contact}" context="${context}"/>
                </td>
            </tr>
            <tr>
                <td class='TbBottom'>
                    <app:editContactToolbar create="${isCreate}" context="${context}" keys="false"/>
                </td>
            </tr>
            </table>
        <input type="hidden" name="doContactListViewAction" value="1"/>
        <input type="hidden" name="id" value="${contact.id}"/>
    </form>

</app:view>

</body>
</html>
