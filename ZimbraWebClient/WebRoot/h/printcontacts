<%@ page buffer="8kb" autoFlush="true" %>
<%@ page pageEncoding="UTF-8" contentType="text/html; charset=UTF-8" %>
<%@ taglib prefix="zm" uri="com.zimbra.zm" %>
<%@ taglib prefix="app" uri="com.zimbra.htmlclient" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>
<%@ taglib prefix="fmt" uri="com.zimbra.i18n" %>
<app:handleError>
    <zm:getMailbox var="mailbox"/>
    <c:choose>
        <c:when test="${not empty mailbox.prefs.locale}">
            <fmt:setLocale value='${mailbox.prefs.locale}' scope='request' />
        </c:when>
        <c:otherwise>
            <fmt:setLocale value='${pageContext.request.locale}' scope='request' />
        </c:otherwise>
    </c:choose>
    <fmt:setBundle basename="/messages/ZhMsg" scope="request"/>
    <c:set var="contactIds" value="${fn:join(paramValues.id, ',')}"/>
</app:handleError>
<html>
<app:head mailbox="${mailbox}"/>
<body style='background-color:white;'>
<style>
    .contactHeader, .ZhFolderHeader {
        font-size: small !important;
    }
    .companyName{
        font-size: small !important;
        color: #555555 !important;
    }
    .sectionLabel{
        font-size: small !important;
        color: gray !important;
    }
</style>
<div class='ZhCallListPrintView'>
<table><tr>
    <td class='ZhZimbraTitle'><fmt:message key="zimbraTitle"/></td>
    <td nowrap width='1%'><b>${fn:escapeXml(mailbox.name)}</b></td>
</tr></table>
<hr/>
<table cellpadding="0" cellspacing="5" width="99%" align="center">
<tr>
<td>
<c:if test="${not empty contactIds}">
    <c:forEach items="${contactIds}" var="contactId" varStatus="status">
        <zm:getContact id="${contactId}" var="contact"/>
        <div  style="border:1px solid rgb(204, 204, 204); padding:1px;margin:10px;float:left;min-width:45%;">
          <app:displayContact contact="${contact}"/>
        </div>
    </c:forEach>
</c:if>

<c:if test="${empty contactIds}">
    <zm:computeSearchContext var="context" types="contact" limit="1000" usecache="true"/>
    <c:forEach items="${context.searchResult.hits}" var="hit" varStatus="status">
        <zm:getContact id="${hit.contactHit.id}" var="contact"/>
        <div  style="border:1px solid rgb(204, 204, 204); padding:1px;margin:10px;float:left;min-width:45%;">
            <app:displayContact contact="${contact}"/>
        </div>
    </c:forEach>
</c:if>
</td>
</tr>
</table>
</div>
<script type="text/javascript">
    <!--
    setTimeout('window.print()', 2000);

    // -->
</script>
</body>
</html>