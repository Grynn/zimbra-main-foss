<%@ page buffer="8kb" autoFlush="true" %>
<%@ page pageEncoding="UTF-8" contentType="text/html; charset=UTF-8" %>
<%@ taglib prefix="zm" uri="com.zimbra.zm" %>
<%@ taglib prefix="app" uri="com.zimbra.htmlclient" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt" %>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<fmt:setBundle basename="/msgs/ZhMsg" scope="session"/>

<c:if test="${!empty param.doAction}"><app:contactListViewAction/></c:if>

<app:handleError>
    <zm:computeSearchContext var="context" types="contact" usecache="true"/>
    <zm:currentResultUrl var="closeUrl" value="/h/search" context="${context}"/>

    <zm:getContact id="${empty param.id ? context.currentItem.id : param.id}" var="contact"/>
    <zm:computeNextPrevItem var="cursor" searchResult="${context.searchResult}" index="${context.currentItemIndex}"/>

</app:handleError>

<app:head title="${contact.displayFileAs}"/>

<body>
<app:view selected="contacts" contacts="true" tags="true" context="${context}">
    <zm:currentResultUrl var="currentUrl" value="contact" context="${context}"/>
    <form action="${currentUrl}" method="post">
        <input type="hidden" name="id" value="${contact.id}"/>
        <app:contactToolbar top='true' context="${context}" cursor="${cursor}" keys="true" closeurl="${closeUrl}"/>
        <div class='ZhAppContent'>
            <app:displayContact contact="${contact}"/>
        </div>
        <app:contactToolbar top='false' context="${context}" cursor="${cursor}" keys="false" closeurl="${closeUrl}"/>
        <input type="hidden" name="doAction" value="1"/>
    </form>
</app:view>

</body>
</html>
