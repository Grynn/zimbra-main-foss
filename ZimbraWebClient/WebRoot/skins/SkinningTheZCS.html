<html>
<head>
<title>Themes for the Zimbra Collaboration Suite</title>
<style type='text/css'>
*				{	font-family:Verdana; 	}
BODY, P, LI		{	font-size:12px;	}

P				{	margin:10px;	}

H1, H2, H3, H4	{
					border-bottom:1px solid black; padding:3px;
					margin:0px;
				}
H1				{	font-size: 24px; background-color:#cccccc; margin-bottom:5px;	}
H2				{	font-size: 20px; background-color:#dddddd; 
					margin-top:20px;
				}
H3				{	font-size: 16px; background-color:#eeeeee; margin-top:20px;
				}

H4				{	padding-left:0px;	margin-left:10px; padding-top:10px;}
LI				{	margin-bottom:5px; }

TH				{	text-align: left; 	}


.headerTable	{	width:100%;	}
.smallTable		{	margin-left:20px;						
					border-collapse:collapse;
				}
.smallTable TD,
.smallTable TH	{	border:1px solid #cccccc; font-size:10px;
					padding-left:5px;	padding-right:15px; 
					vertical-align:top;
				}

.smallText		{	font-size:10px;	}	

.nowrap			{	white-space: nowrap;	}

file,
fileTitle		{	color:darkgreen; font-weight:bold;	}

tocName,
fileTitle		{	font-weight:bold; background-color:#cccccc; 
					padding:5px; 
					margin:-5 -5 5 -5;
					display:block;
				}
indent			{	display:block;	margin-left:30px; 	}

sampleFile,
toc,
exampleBlock,
.gray			{	display:block; 	background-color:#eeeeee;	
					padding:10px;
				}	

exampleBlock,
sampleFile		{
					padding:10px;	margin:10px; 	
				}	
tocEntry		{	display:block;	}

important		{	font-weight:bold;	}
example			{	font-weight:bold;	}
code			{	font-family:monospace; white-space:pre;	}
todo			{	color:darkred; font-weight:bold;	}

topLink			{	font-size:10px;	font-weight:normal; 
					float:right; position:relative;	display:block;
					margin-right:10px; margin-top:5px;
					vertical-align:bottom; 
				}
topLink a		{	text-decoration:none;	}				

var				{	font-style:italic;	}

ol.roman li			{	 list-style:upper-roman;	font-size:10px;	}
ol.roman ol li		{	 list-style:decimal;font-size:10px;	}
ol.roman ol ol li	{	 list-style:lower-alpha;	font-size:10px;}
ol.roman ol ul li	{	 list-style:disc;font-size:10px;	}
</style>

</head>
<body>
<H1><a name=top>Themes for the Zimbra Collaboration Suite</a></H1>

<table class='headerTable'>
<tr>
	<td valign=top width=50%>
		<div class='gray'>
			<tocName>Table of Contents</tocName>
			<ol class='roman'>
				<li><a href=#about>About Themes in ZCS</a></li>
				<li><a href=#short>The Short Version</a></li>
				<ol>
					<li><a href=#location>Where the Theme Files Live</a></li>
					<li><a href=#quick>Creating a Simple Theme</a></li>
				</ol>
				<li><a href=#long>The Long Version</a></li>
				<ol>
					<li><a href=#components>Components of a ZCS Theme</a></li>
					<li><a href=#manifest>The Theme Manifest</a></li>
					<li><a href=#subs>Editing Theme Substitution Files</a></li>
					<ol>
						<li><a href=#changeable>What You Can Change</a></li>
						<li><a href=SkinColorPicker.html target=_blank>Theme Color Picker(&rArr;)</a></li>
						<li><a href=#browserspecific>Browser-Specific Substitutions</a></li>
					</ol>
					<li><a href=#html>Editing Theme HTML and CSS Files</a></li>
					<ul>
						<li><a href=#api>The Theme/ZCS API</a></li>
					</ul>
						
					<li><a href=#images>Changing the Logo Images</a></li>
					<ul>
						<li><a href=#inside>For Open Source Customers</a></li>
					</ul>
					<li><a href=#deploy>Deploying a Theme</a></li>
					<ol>
						<li><a href=#deployCompiled>Deploying from a Pre-Packaged Binary Distribution</a></li>
						<li><a href=#deploySource>Deploying from a Source Files</a></li>					
					</ol>
				</ol>
			</ol>
		</div>
	</td>
	<td valign=top>
		<table class='smallTable' cellspacing=0 cellpadding=2;>
			<tr><th>Author</th><th>Date</th><th width=50%>Description</th></tr>
			<tr><td class=nowrap>Owen Williams</td>
				<td class=nowrap>June 21, 2006</td>
				<td>Created</td>
			</tr>
		</table>
	</td>
</tr></table>


<H2><topLink><a href=#top>top</a></topLink>
	<a name=about>About Themes in ZCS</a>
</H2>
<p>
This document covers the basic information you will need to create a user interface theme (known in the code as a "skin") for the <a href='http://www.zimbra.com/products/' target=_blank>Zimbra Collaboration Suite (&rArr;)</a> (ZCS).  You can create a theme as simply as setting two colors and their variants, or you make heavy modifications to the "chrome" or outlines of the user interface with extensive use of images.  This guide is more oriented toward creating simpler variants of existing themes, but information is provided about the details of how the theming mechanism works to enable you to create more advanced themes.
<p>
Note that while the theming mechanism is very flexible, we recommend in this version of ZCS that you limit yourself to just changing colors and fonts.  While there is nothing preventing you from making more advanced themes, we cannot guarantee that these themes will survive upgrades to the framework as we are planning some changes in the near future that will shift some things around.  So if you don't mind having to possibly go back to the drawing board at some time in the future, go ahead and play around all you like.
<p>
If you have any questions or themes you want to share with the world, feel free to post them on the <a href=http://www.zimbra.com/forums/ target=_blank>Zimbra Forums (&rArr;)</a>.


<H2><topLink><a href=#top>top</a></topLink>
	<a name=short>The Short Version</a>
</H2>
<p>
Below we walk you through the simplest way to create a theme, which will be based on one of the sample themes provided.  For the example, we will be creating a theme called <file>test</file> based on the <file>light</file> theme sample.

<H4><topLink><a href=#top>top</a></topLink>
	<a name=location>Where the Theme Files Live</a>
</H4>

<p>
The directory in which you will deploy the new theme is based on whether you have received a pre-built release of the ZCS, or if you have built the ZCS yourself from the source files.
<ul>
	<li>If using a pre-build release, you will be using directory:
		<indent><file>/opt/zimbra/tomcat/webapps/zimbra/skins/
	</li>
	<li>If you are building the ZCS from source, you will use:
		<indent><file>ZimbraWebClient/WebRoot/skins/
	</li>
</ul>
<p>
We will use the notation <file>.../skins/</file> to indicate the directory above appropriate to your situation.


<p>
<H4><a name=quick>Creating a Simple Theme</a></H4>

<ol>
	<li>Decide which theme you want to base your new theme on and locate its sample directory below:
		<ul>
			<li><file>light</file> theme (eg: <file>Sand</file>) -- directory <file>.../skins/_samples/light</file>

			<li><file>dark</file> theme (eg: <file>Money</file>) -- directory <file>.../skins/_samples/dark</file>

			<li><file>consumer</file> theme (eg: <file>Bare</file>) -- directory <file>.../skins/_samples/consumer</file>

		</ul>
	<li>Copy the sample directory above into: <file>.../skins/</file>
	
	<li>Rename the directory the same name as your theme.

		<exampleBlock>Eg: for our example, we would have copied <br>
	<indent><file>.../skins/_samples/light/</file></indent>
			as
			<indent><file>.../skins/test/</file></indent>
		</exampleBlock>
		
	<li>For each file in the directory, rename it to
		<file>[theme]*</file>, where "[theme]" 
		is the same name as the directory, eg:

		<sampleFile>
			<file>.../skins/test/</file><br>
			<indent>
				<file>test.xml</file><br>
				<file>test_subs.txt</file><br>
			</indent>
		</sampleFile>
	
	<li>Edit <file>[theme].xml</file>.  Change all occurances of <file>[theme]</file> to your theme name.
	
		<sampleFile>
		<fileTitle>file: .../skins/test/test.xml</fileTitle>
			<code>&lt;skin></code>
			<indent>
				<code>&lt;substitutions></code>
				<indent>
<code>&lt;file></code>../_base/base/base_subs.txt<code>&lt;/file></code><br>			<code>&lt;file></code>../_base/light/light_subs.txt<code>&lt;/file></code><br>
					<code>&lt;file></code><file>test_subs.txt</file><code>&lt;/file></code>
				</indent>
				<code>&lt;/substitutions></code><br>
				<code>&lt;css></code>
				<indent>
					<code>&lt;file></code>../_base/light/light.css<code>&lt;/file></code>
				</indent>
				<code>&lt;/css></code><br>
				<code>&lt;html></code>
				<indent>
					<code>&lt;file></code>../_base/light/light.html<code>&lt;/file></code>
				</indent>
				<code>&lt;/html></code>
			</indent>
			<code>&lt;/skin></code>
		</sampleFile>
	
	
	<li>Edit <file>[theme]_subs.txt</file>.  Customize any of the entries there.  See <a href=#subs>Editing Theme Substitution Files</a> for details.
	
	<li>Make the servers aware of the new theme and restart the servers.  See <a href=#deploy>Deploying a Theme</a>
	
	<li>You're done!
</ol>




<H2><topLink><a href=#top>top</a></topLink>
	<a name=long>The Long Version</a>	
</H2>
<p>
This gets into the gory details of how the theming mechanism works, probablly explaining more than you'd really like to know, and definitely more than you <i>need</i> to know to create a theme.




<H3><topLink><a href=#top>top</a></topLink>
	<a name="components">Components</a> of a ZCS Theme
</H3>
<p>
A theme is composed of a single directory which contains a number of text and image files.  Generally, the names of the text files are prefixed with the name of the theme.  For example, for the theme named <file>sand</file>, you would use files <file>sand.html</file>, <file>sand.xml</file>, etc.  In this document, whenever you see <file>[theme]</file> in a file name, substitute the name of your theme (e.g., <file>[theme].xml</file> in the <file>sand</file> theme would really mean file <file>sand.xml</file>).

<p>
All theme files live in the <file>.../skins/</file> directory (see <a href=#location>Where the Theme Files Live</a>).  In general, each directory there corresponds with a single theme available to users of the ZCS.  Note that the directories <file>.../skin/_sample/</file> and <file>.../skin/_base/</file> are special directories used to create themes -- these are not exposed as themes to the user.

<p>
To create a new theme, create a folder with the name of your theme in the <file>.../skins/</file> directory.  (The examples will use the theme name <file>test</file>).  Note that currently, spaces are not allowed in the folder name.  Within this folder you can have the following files:
<ul>
	<li><file>[theme].xml</file> (mandatory): This is the "manifest" for your theme, which details all of the other files that make up the theme.  See <a href=#manifest>The Theme Manifest</a> below.

	<li><file>[theme]_subs.txt</file> (mandatory):  This sets up a number of substitutions which are performed in the other theme files that customizes their appearance.  For example, this is where the background color of elements are set, where fonts are defined, etc.  See <a href=#subs>Editing Theme Substitution Files</a> below.
	
	<li><file>[theme].html</file> (optional):  This is the HTML responsible for drawing the theme, along with the javascript required to show or hide parts of the theme dynamically.  In general, you will be pointing to an HTML file in the <file>skins/_base</file> directory rather than creating your own.  See <a href=#html>Editing Theme HTML and CSS files</a>.
	
	<li><file>[theme].css</file> (optional):  This is CSS definitions that are paired with the elements in <file>[theme].html</file>.  In general, you will be pointing to a CSS file in the <file>skins/_base</file> directory rather than creating your own.  See <a href=#html>Editing Theme HTML and CSS files</a>.
<!--	
	<li><file>img/</file> directory (optional):  Place images in here to use them in your theme - they will automatically replace any normal application image of the same name.  For example, to replace the application logo image that appears on the login and splash screen, place an image entitled <file>LoginBanner.png</file> in your <file>img/</file> directory.  See <a href=#images>Including Images in a Theme</a>.
-->
</ul>

<p>
Note that some of the files listed above are deemed (optional) -- for these files, some you can omit entirely, and for some you can set things up in the manifest to use the corresponding file in another theme.  See <a href=#manifest>The Theme Manifest</a> for details.

<p>
For example, to fully create a theme named <file>test</file>, you might have the following directory structure:<br>
<sampleFile>
	<file>.../skins/test/</file><br>
	<indent>
		<file>test.xml</file><br>
		<file>test_subs.txt</file><br>
		<file>test.html</file><br>
		<file>test.css</file><br>
		<file>logo/</file><br>
		<indent>
			<file>AppBanner.png</file><br>
			<file>LoginBanner.png</file><br>
		</indent>
	</indent>
</sampleFile>





<H3><topLink><a href=#top>top</a></topLink>
	<a name=manifest>The Theme Manifest</a>
</H3>
<p>
The theme manifest (<file>[theme].xml</file>) defines the location
of the files that make up the theme.  For a fully-specified theme named <file>test</file>, it would look like:

<sampleFile>
<fileTitle>file: .../skins/test/test.xml</fileTitle>
	<code>&lt;skin></code>
	<indent>
		<code>&lt;substitutions></code>
		<indent>
			<code>&lt;file></code><file>test_subs.txt</file><code>&lt;/file></code>
		</indent>
		<code>&lt;/substitutions></code><br>
		<code>&lt;css></code>
		<indent>
			<code>&lt;file></code><file>test.css</file><code>&lt;/file></code>
		</indent>
		<code>&lt;/css></code><br>
		<code>&lt;html></code>
		<indent>
			<code>&lt;file></code><file>test.html</file><code>&lt;/file></code>
		</indent>
		<code>&lt;/html></code>
	</indent>
	<code>&lt;/skin></code>
</sampleFile>

<!--
<p>
Note that you do not have to list the images in the <file>img/</file> directory for your theme - all of the images in that directory will automatically be loaded for you when your theme is accessed.
-->

<p>

Also, note that you can have more than one <code>&lt;file></code> entry per category, and that these file entries can refer to other themes by locating them in the directory structure.  For example, if theme <file>test</file> wanted to simply provide a small set of changes from theme <file>_base/light</file>, you might have:

<sampleFile>
<fileTitle>file: .../skins/test/test.xml</fileTitle>
	<code>&lt;skin></code>
	<indent>
		<code>&lt;substitutions></code>
		<indent>
			<code>&lt;file></code><file>../_base/base/base_subs.txt</file><code>&lt;/file></code><br>			<code>&lt;file></code><file>../_base/light/light_subs.txt</file><code>&lt;/file></code><br>

			<code>&lt;file></code><file>test_subs.txt</file><code>&lt;/file></code>
		</indent>
		<code>&lt;/substitutions></code><br>
		<code>&lt;css></code>
		<indent>
			<code>&lt;file></code><file>../_base/light/light.css</file><code>&lt;/file></code>
		</indent>
		<code>&lt;/css></code><br>
		<code>&lt;html></code>
		<indent>
			<code>&lt;file></code><file>../_base/light/light.html</file><code>&lt;/file></code>
		</indent>
		<code>&lt;/html></code>
	</indent>
	<code>&lt;/skin></code>
</sampleFile>

This indicates that the <file>light</file> theme files should be used in addition to or in place of the corresponding files in this theme.  In particular:
<ul>
<li>
	for the <a href=#subs>substitutions</a>, the file
		<file>base_subs.txt</file> will be loaded first, then <file>light_subs.txt</file> will be loaded (overriding any similarly-named entities in <file>base_subs.txt</file>), 
		and then the entries in <file>test_subs.txt</file> will 	
		override the correspondingly named entries in both base files.
<li>the theme does not specify its own <a href=#html>CSS and HTML</a> files, instead relying completely on the <file>light</file> theme for its HTML and CSS. 
</ul>

<p>
<span class=important>This is generally how you will set up your theme.</span>
Although it is possible to completely redefine the HTML and CSS files for your theme, it is <span class=important>strongly</span> recommended that you use the base HTML and CSS files and simply change the substitutions that are performed in the css.  This way you can be assured that your theme will survive upgrades to the ZCS application.  Changes to the HTML and CSS files (as well as changes to private entries in the [theme]_subs file) are not guaranteed to survive upgrades.

<p>
Note that you can add extra <code>&lt;file></code> entries in any of the categories in your manifest -- the files will automatically be loaded in the order listed.  Make sure you include a file of the corresponding type as its category.  For example, to include a Javascript file, name it <file>foo.html</file> and make sure it has <code>&lt;SCRIPT language='JavaScript'>...&lt;/SCRIPT></code> tags around the actual Javascript content.  CSS files do not need to be encoded in this way -- just list your CSS entries as if the file was <code>@import</code>ed as a separate link.

		
		
		
		
<H3><topLink><a href=#top>top</a></topLink>
	<a name=subs>Editing Theme Substitution Files</a>
</H3>

<p>
All of the CSS files that are used within the ZCS application, as well as those defined in your theme, use a special substitution syntax to allow the theming process to work.  The ZCS server application uses the substitution file(s) supplied with a theme to process all of the CSS files and apply colors, fonts, borders, etc to the ZCS applications and widgets.  This happens automatically when the server is running and is completely transparent to the browser.

<p>
If you were to look in the unprocessed css files that comprise the ZCS application, you would see a number of entries like so:

<sampleFile>
<fileTitle>file: somefile.css</fileTitle>
	...<br>
	P, TD, DIV, SPAN, SELECT, INPUT, TEXTAREA, BUTTON, A {
	<indent>
		<example>@Text@</example>
	</indent>
	}<br>
	...<br>
	.DwtButton				{	<example>@NormalButton@</example>	}<br>
	...
</sampleFile>

The <example>@xxx@</example> syntax there indicates that an entry in the substitution file(s) with that name should be placed at that spot in the CSS files.  This gives us a very powerful way to apply different styles to the widgets within the application, while not slowing down the browser to perform these substitutions at runtime.

<p>
Looking at a sample <file>[theme]_subs.txt</file> file, you'll see entries like so:

<sampleFile>
<fileTitle>file: .../skins/test/test_subs.txt</fileTitle>
<code>
_SkinName_          = test
SkinImgDir          = /zimbra/skins/test/img
...
# Base color of the app: note that this is designed for a monochrome interface.
_BaseColor_         = #e8dcc1
_BaseColorD10_      = #d0c6ad
_BaseColorL25_      = #efe7d4
...
# selection color: used for selected row, focus items and default buttons
_SelColor_          = #acc0dd
_SelColorD10_       = #9aacc6
_SelColorL20_       = #8a9ab1
...
# misc. colors
HilightColor        = #e3da93
MatchedColor        = @HilightColor@
...
# Logical zones in the theme
ChromeBg            = background-color:@_BaseColor_@;
ChromeText          = @Text@
InsetBg             = background-color:@_BaseColorL75_@;
InsetText           = @Text@
...
# fonts and sizes
FontFamily-default  = font-family:Tahoma, Arial, Helvetica, sans-serif;
FontFamily-fixed    = font-family:monospace;
FontFamily-html     = font-family:Verdana,Arial,serif;
...
FontSize-normal     = font-size:11px;
FontSize-big        = font-size:13px;
...
# Text colors and styles (for use in widgets, app regions, etc)
Text                = color: black;
Label               = @Label-wrap@ white-space:nowrap; overflow:hidden;
...
</code>
</sampleFile>
</pre>

<p>
Each line in the substitutions file represents a single substution -- the entry on the left side is the variable name, and the text on the right of the equals sign is the value that will replace it.  Lines that begin with a pound sign (<code>#</code>) are comments.

<p>If more than one substitution file is specified in the manifest, an entry named <example>foo</example> in the second file listed will override an entry named <example>foo</example> in the first file, etc.
<p>
Note that before the substition file is run on the CSS files, <b>substitutions are run on the substitution file itself</b>, which is why you will sometimes see <example>@foo@</example> entries on the right hand side of some lines.  This is deliberate -- it allows us to define some logical entries within the substituion file and use them repeatedly within the rest of the subs file.  The order in which the substitions are defined is not important.
<p>
<important>Note that all substitutions that begin and end with an underscore (eg: <example>_foo_</example>) are only to be used within the substitution file itself -- consider them "private" variables.</important>  Althought there is nothing preventing you from using the underscore substitutions in other files, they are not guaranteed to be there in future versions of the system.


<H4><topLink><a href=#top>top</a></topLink>
	<a name=changeable>What You Can Change</a>
</H4>
<p>
As a rule of thumb, it is safe for you to change anything in the <file>[theme]_subs.txt</file> that you copied from the <file>.../skins/_sample/</file> directory.   While there are literally hundreds of substitutions that can be used in the CSS files, we recommend that in this version of ZCS you limit yourself to only changing colors, fonts and logo images as indicated in the sample file.  To see the other things that you can possibly change, take a look at the file <file>.../skins/_base/base/base_subs.txt</file>.  You can change the other substitutions, but they may not survive upgrades to the system.

<p>
Most commonly, you will want to change the colors of the theme.  The sample  themes define a single <code>_BaseColor_</code> that is used to give the theme a consistent color theme.  The HTML, CSS, and substitution files are crafted to use subtle light and dark variants of this color to achieve effects like attractive buttons that look like they raise and lower, without the use of images.  To define a <code>_BaseColor_</code>, use the 
	<a href=SkinColorPicker.html target=_blank>Theme Color Picker (&rArr;)</a> to pick the colors interactively, then copy and paste the list of color variants into your <file>[theme]_subs.txt</file> file.
<p>
The themes also define a <code>_SelColor_</code> which is the color used to show selected rows in lists, default buttons, etc.  The <a href=SkinColorPicker.html target=_blank>Theme Color Picker (&rArr;)</a> will also help you set the <code>_SelColor_</code> and its variants.

<!--
<p>
Note that the <file>consumer</file> theme also specifies a separate background color for the entire application, to set this color, simply change the <code><todo>NAME???</todo></code> entry in your <file>[theme]_subs.txt</file> file.
-->

<p>See <a href=#images>Changing the Logo Images</a> for how to use custom logo images in your theme.


<H4><topLink><a href=#top>top</a></topLink>
	<a name=browserspecific>Browser-Specific Substitutions</a>
</H4>

<p>You will occasionally see <code>#IFDEF XXX</code> in the substitution files.  This is a way to ensure that certain substitutions only appear in certain browsers.  The server will parse this at runtime and will eliminate any <code>IFDEF</code>ed code that does not match the browser being served to.  There are many variables you can <code>IFDEF</code> on, but the most commonly used are:
<ul>
	<li><code>MSIE</code>
	<li><code>GECKO</code> (all netscape-based browsers)
	<li><code>SAFARI</code>
</ul>
<p>
This <code>IFDEF</code> logic also applies to the HTML and CSS files that make up your theme, and is also performed automatically before the server sends the files to the client.
<p>
Note that the themes take advantage of browser-specific CSS properties to make the theme more attractive when possible.  Specifically, the sample themes use the <code>-moz-border-colors</code> and <code>-moz-border-radius</code> attributes to make the pieces of the theme look round in FireFox.  IE and Safari do not support these attributes, so they have a more square look.


<H3><topLink><a href=#top>top</a></topLink>
	<a name=html>Editing Theme HTML and CSS files</a>
</H3>
<p>
The theme HTML and CSS files are what actually draws the borders of the theme, and exposes the interface that tells the application where to position different pieces of the ZCS interface, like the overview tree, the search toolbar, etc.  The theme is responsible for laying out all of the pieces of the application, and for resizing the pieces of the theme automatically when the browser is resized.  The theme HTML file is also responsible for exposing a simple interface for showing and hiding different parts of the theme dynamically.  For example, sometimes the mini-calendar below the tree should be hidden.  The theme exposes <code>skin.showTreeFooter()</code> and <code>skin.hideTreeFooter()</code> routines that the app manager uses to show or hide that region of the interface.  The theme is responsible only for showing and hiding the outline of that portion of the UI an making sure that the rest of the theme reflows properly -- the app manager code will make sure that the components get placed properly and resized.
<p>
There are a number of <code>&lt;div></code>'s that the theme must define in order for the application to know where to put the corresponding application element.  These are identified by id within the <file>[theme].html</file>.  The theme is free to put whatever other "chrome" around these elements that it wants to to make the theme look pretty.  The <file>[theme].css</file> file is used to position the various pieces of the <file>[theme].html</file> file.
<p>
<important>We strongly recommend that you use one of the standard sets of CSS and HTML files, rather than creating your own.</important>  This way you can be ensured that your theme survives upgrades to future versions of ZCS.

<h4><topLink><a href=#top>top</a></topLink>
	<a name=api>The Theme/ZCS API</a>
</h4>
<p>
The list of ID'd elements that the application looks for within the theme are listed below.  Note that you <b>must</b> provide all of the named elements within your theme (even if they are hidden) or the application will generate an error on startup.
<p>
The theme and ZCS application use a simple API to show and hide various parts of the theme.  It is completely up to your theme how it wants to show and hide these elements -- you can either use AjaxToolKit routines to do so, or you can create your own simple API for doing this.  

<p>The <code>skin.show<var>X</var>()</code> routine takes a single argument, which is a boolean indicating whether to show (true) or hide the element.  The <code>skin.hide<var>X</var>()</code> routine takes no arguments, should always hide the element, and can just call <code>skin.show<var>X</var>(false)</code>.  For brevity, only the <code>skin.show<var>X</var>()</code> routines are noted below.


<p>
<table class=smallTable>
	<tr><th>Name</th><th>Description</th><th>Show/Hide API</th></tr>
	<tr><td>skin_outer</td>
		<td>Outer container of the entire skin</td>
		<td><code>skin.showSkin(&lt;boolean>)</code></td>
	</tr>
	<tr><td>skin_container_logo</td>
		<td>Application logo</td>
		<td>(none)</td>
	</tr>
	<tr><td>skin_container_search</td>
		<td>Search toolbar</td>
		<td>(none)</td>
	</tr>
	<tr><td>skin_container_quota</td>
		<td>User name and quota area</td>
		<td><code>skin.showQuota(&lt;boolean>)</code></td>
	</tr>
	<tr><td>skin_container_search_builder_toolbar</td>
		<td>Toolbar for the search builder.</td>
		<td><code>skin.showSearchBuilder(&lt;boolean>)</code><br>
			shows search builder and its toolbar
		</td>
	</tr>
	<tr><td>skin_container_search_builder</td>
		<td>Search builder area</td>
		<td>(see above)</td>
	</tr>
	<tr><td>skin_container_current_app</td>
		<td>Displays the current app and view menu</td>
		<td>(none)</td>
	</tr>
	<tr><td>skin_container_tree_app_sash</td>
		<td>Draggable vertical border between tree and app areas</td>
		<td>(none)</td>
	</tr>
	<tr><td>skin_container_app_top_toolbar</td>
		<td>Toolbar area for the main app</td>
		<td><code>skin.showTopToolbar(&lt;boolean>)</code></td>
	</tr>
	<tr><td>skin_container_app_chooser</td>
		<td>Buttons that allow you to switch apps</td>
		<td>(none)</td>
	</tr>
	<tr><td>skin_container_tree</td>
		<td>Overview tree</td>
		<td>(none)</td>
	</tr>
	<tr><td>skin_container_tree_footer</td>
		<td>Mini-calendar shown below tree</td>
		<td><code>skin.showTreeFooter(&lt;boolean>)</code></td>
	</tr>
	<tr><td>skin_container_app_main</td>
		<td>Main application area</td>
		<td>(none)</td>
	</tr>
	<tr><td>skin_container_status</td>
		<td>Status area -- shows time and transient status messages</td>
		<td>(none)</td>
	</tr>
</table>

<p>There is one other routine that your theme must implement:
	<indent><code>skin.setTreeWidth(newWidth)</code></indent>
This is called by the application when the user drags the "sash" or split bar to resize the tree horizontally.  <code>newWidth</code> is the absolute width in pixels for the current size of the tree.


<H3><topLink><a href=#top>top</a></topLink>
	<a name=images>Changing the Logo Images</a>
</H3>
<p>
One common reason to create a new theme is to change the logo images shown in the login and splash screen, as well as the small logo shown in the upper-left of the application screen.  You can also change the URL that is linked to when the logo is clicked.  

<H4><topLink><a href=#top>top</a></topLink>
	<a name=inside>For ZCS Network Customers</a>
</h4>
<p>
You can customize the logo and URL to which it links at your preference.  To do so:


<ol>
	<li>Create an <file>logo/</file> directory in your theme directory (e.g., <file>.../skins/test/logo/</file>) and add the following images:

<p>
<table class=smallTable>
	<tr><th>Image File</th>
		<th>Description</th>
		<th>Width</th>
		<th>Height</th>
	</tr>
	<tr><td><file>LoginBanner.png</file></td>
		<td>Company logo that shows up on the login and splash screens</td>
		<td>450</td>
		<td>100</td>
	</tr>
	<tr><td><file>AppBanner.png</file></td>
		<td>Logo in the upper-left of the application as it is running</td>
		<td>120</td>
		<td>35</td>
	</tr>
</table>

<p>
Note that these images must be the size specified above, or the application may not lay out correctly, and that they must be saved in the PNG format.  We recommend that you save them as 24-bit PNGs so that they can have alpha-channel blending on their edges or shadows, that will look good no matter the background color of your theme.

	<li>Modify your <file>[theme]_subs.txt</file> to update the <code>LogoImgDir</code> entry to point to your <file>img/</file> directory and your company URL:
	
	<sampleFile>
	<fileTitle>.../skins/test/test_subs.txt</fileTitle>
	<code>
...
LogoImgDir          =	/zimbra/skins/<file>test</file>/img
LogoURL             =	http://www.yourcompany.com
...</code>
	</sampleFile>
		
</ol>

<H4><topLink><a href=#top>top</a></topLink>
	<a name=inside>For Open Source Community Users</a>
</h4>
<p>
<img src='http://www.zimbra.com/_media/zimbrainside_logo.gif'
	style='float:right; margin-left:5px;'>
If you are using ZCS under the <a href=http://www.zimbra.com/license/zimbra_public_license_1.2.html target=_blank>open-source license</a>, your use of the logo will fall under one of two categories:
<ol>
	<li>If you have made no change to the application other than creating new theme(s), you <b>must</b> leave the Zimbra logo and URL intact.
	
	<li>If you have made changes to the application's source code, you <b>must</b> use the "ZimbraInside" logo and link to the url <a href=http://www.zimbra.com/inside target=_blank>http://www.zimbra.com/inside (&rArr;)</a>.  To do this, change your <file>[theme]_subs.txt</file> file like so:

	<sampleFile>
	<fileTitle>.../skins/test/test_subs.txt</fileTitle>
	<code>
...
LogoImgDir          =	/zimbra/skins/_base/logos/ZimbraInside
LoginBannerHeight   =	150px
LogoURL             =	http://www.zimbra.com/inside
...</code>
	</sampleFile>

</ol>

<p><important>For all open source community users, using any other logo or linking to a different page violates your license agreement to use the Zimbra Collaboration Suite.</important>


<!--
It is possible for your theme to override any of the images used within the normal ZCS application, from logos to the icons to represent the different applications, to the toolbar icons within the application.  To do so, create an <file>img/</file> directory in your theme directory (e.g. <file>.../skins/test/img/</file>) and add images with the same name as images used within the app.  Note that it is important that your images be saved in the same format as the original image (e.g., if the original image is a GIF, as most are, yours should be a GIF as well).  This is especially important for PNG images, which are rendered in a specific way to make them work in Internet Explorer.  Also, note that while it is technically possible for your images to be larger or smaller than the default images, this may result in the application looking unbalanced due to sizing assumptions made within the application code.

<p>
When you <a href=#deploy>test and deploy</a> your theme, the ZCS build system will automatically consolidate your images into the smallest number of files possible, and will create CSS entries for each image that you can use to efficiently reference an image within your theme.  For example, an image named <code>SomeImage.gif</code> will automatically result in a CSS rule called <code>ImgSomeImage</code> that will be loaded with your theme.  To show the image in a particular HTML element, reference its image class, eg:
	<exampleBlock>
		<code>&lt;DIV class='ImgSomeImage'>&lt;/DIV></code>
	</exampleBlock>
The <code>&lt;DIV></code> above will automatically be sized correctly, and will show the <code>SomeImage.gif</code> file as its background image.  This is much more efficient than referencing the image natively with an <code>&lt;IMG></code> tag.

<p>
There are essentially two master directories that the images come from in the ZCS development environment:
<p>
<table class=smallTable>
	<tr><td><file>Ajax/img/*</file></td>
		<td>generic images from the Ajax toolkit, for example, 
			the arrow that represents a menu, the "warning" and "info" 
			icons, etc</td>
	</tr>
	<tr><td><file>ZimbraWebClient/img/*</file></td>
		<td>all of the icons and images specific to the ZCS application</td>
	</tr>
</table>
<p>
<todo>WHAT ABOUT INSTALLS FROM PRE-BUILT SOURCE?</todo>

<p>You do not have to place your images in the directory structure inherent in the directories above, but note that all GIF images in a directory <b>must</b> share exactly the same color palette.  This can be accomplished in Photoshop by creating a single file with all of your icons, then changing the image to 8-bit, saving the color palette, then using the slice tool in photoshop to "Save For Web..." your images using the saved color palette.  If this sounds confusing, consult your friendly local graphic designer and they should be able to walk you through this.

-->




<H3><topLink><a href=#top>top</a></topLink>
	<a name=deploy>Deploying a Theme</a>
</H3>
<p>
Deploying a theme is simple, but how you do it depends on if you are using a pre-packaged binary distribution of the application or building from the source code.  In the instructions below, text in the <code>code font</code> is what you will type at the command line.

<H4><topLink><a href=#top>top</a></topLink>
	<a name=deployCompiled>Deploying from a Pre-Packaged Binary Distribution</a>
</H4>
<ol>
	<li>Open a terminal or dos window.
	<li>Log in as the Zimbra user:<br>
		<code>     su - zimbra</code>
	<li>Tell the server about the new theme:<br>
		<code>     zmprov mcf +zimbraInstalledSkin <file>themeName</file></code> 
	<li>Restart the server:<br>
		<code>     zmcontrol stop</code><br>
		<code>     zmcontrol start</code>
	<li>And you're done!  You should now be able to log in and switch to the new theme in the Options screen.
</ol>


<H4><topLink><a href=#top>top</a></topLink>
	<a name=deploySource>Deploying from a Source Files</a>
</H4>
<ol>
	<li>Open a terminal or dos window.
	<li>Tell the server about the new theme:<br>
		<code>     /opt/zimbra/bin/zmprov mcf +zimbraInstalledSkin <file>themeName</file></code> 
	<li>Go to your <file>ZimbraWebClient/</file> directory and re-build the source:<br>
		<code>     ant clean deploy</code>
	<li>Restart the server:<br>
		<code>     /opt/zimbra/bin/zmcontrol stop</code><br>
		<code>     /opt/zimbra/bin/zmcontrol start</code>
	<li>And you're done!  You should now be able to log in and switch to the new theme in the Options screen.
</ol>
