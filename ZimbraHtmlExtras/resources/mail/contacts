<%@ page buffer="8kb" autoFlush="true" %>
<%@ page pageEncoding="UTF-8" contentType="text/html; charset=UTF-8" %>
<%@ taglib prefix="zm" uri="com.zimbra.zm" %>
<%@ taglib prefix="app" uri="com.zimbra.htmlextras" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt" %>

<%--
paramaters:
  offset=...
  query=...
--%>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>${empty param.query ? 'Contacts' : param.query}</title>

    <style type="text/css">
         @import url( "<c:url value="/style/nifty.css"/>" );
         @import url( "<c:url value="/style/common.css"/>" );
         @import url( "<c:url value="/style/mail.css"/>" );
         @import url( "<c:url value="/style/contacts.css"/>" );        
     </style>
</head>
<body>

<zm:computeSearchContext var="context" default="contacts"/>

<c:set var="toolbar">
							<td class='toolbar unread'><button>Compose</button></td>
							<td class='toolbar'><button>Delete</button></td>
							<td class='toolbar'>
								<select style="width:25ex">
									<option selected disabled>Add to group...</option>
									<option class='actionOption' value='newgroup'>New group...</option>
								</select>
							</td>
							<td width=100%></td>
							<td><nobr><a href="contact">Add Contact</a> - </nobr></td>
							<td><nobr><a href="import">Import</a> - </nobr></td>
							<td style="padding-right:3px"><nobr><a href="export">Export</a></nobr></td>
</c:set>

<zm:getMailbox var="mailbox"/>

<app:view mailbox="${mailbox}">

				<div class="niftyMail">
					<b class="rtopNiftyMail">
						<b class="r1"></b>
						<b class="r2"></b>
						<b class="r3"></b>
						<b class="r4"></b>
					</b>
					<div class="inbox" id="inbox">
						<table border=0 cellpadding=0 cellspacing=0 width=100%>
						<tr>
							${toolbar}
						</tr>
						<tr>
							<td colspan=100>
								<table border=0 width=100% cellpadding=0 cellspacing=0><tr>
									<td class="tab tabSelected">All Contacts</td>
									<td class="tab"><a href="javascript:;">Groups</a></td>
									<td class="nowrap">
										<form action="contacts" method="post">
										<input type="text" size="15">
										<input type="submit" value="Search Contacts">
										</form>
									</td>
									<td width=100%></td>
									<td class="nowrap">
										<c:if test="${param.offset > 0}">
											<a href="contacts?offset=${context.searchResult.prevOffset}">&lt; Prev</a>
										</c:if>
										<b>${context.searchResult.offset+1} - ${context.searchResult.offset+context.searchResult.size}</b>
										<c:if test="${context.searchResult.hasMore}">
											<a href="contacts?offset=${context.searchResult.nextOffset}">Next &gt;</a>&nbsp;
										</c:if>
									</td>
								</tr></table>
							</td>
						</tr>
						<tr>
							<td colspan=100 class='contactsContent'>
								<table border=0 width=100% cellpadding=0 cellspacing=0>
								<tr class="contactHeader contactHeaderCol">
									<td width=25 class="contactBorder">&nbsp;</td>
									<td class="contactName contactBorder">Name</td>
									<td width=25 class="contactBorder">&nbsp;</td>
									<td class="contactHeaderCol contactBorder">Details</td>
								</tr>
								<c:forEach items="${context.searchResult.contactHits}" var="contact">
								<tr>
									<td width=25 class="contactBorder"><input type="checkbox" name=t value="1"></td>
									<td class="contactBorder"><div class="contactName"><a href="contact?id=${contact.id}">${fn:escapeXml(empty contact.fileAsStr ? '<None>' : contact.fileAsStr)}</a></div></td>
									<td width=25 class="contactBorder">&nbsp;</td>
									<td class="contactBorder">
										<c:set var="tagNames" value="${fn:escapeXml(zm:getTagNames(pageContext, contact.tagIds))}"/>
										<span class="labelSmall">${tagNames}</span>
										<span class="contactDetails"><c:if test="${empty contact.displayEmail}">&nbsp;</c:if><a href="contact?id=${contact.id}">${fn:escapeXml(contact.displayEmail)}</a></span>
									</td>
								</tr>
								</c:forEach>
								</table>
								<c:if test="${context.searchResult.size == 0}">
									<div class='noResults'><br><br>You have no contacts. Ha ha.<br><br></div>
								</c:if>
							</td>
						</tr>
						<tr><td height=5></td></tr>
						<tr>
							<td colspan=100 class='actions'>
								Select:
								<a href='javascript:;'>All</a>,
								<a href='javascript:;'>None</a>,
							</td>
						</tr>
						<tr>
							${toolbar}
						</tr>
						</table>
					</div>
					<b class="rbottomNiftyMail">
						<b class="r4"></b>
						<b class="r3"></b>
						<b class="r2"></b>
						<b class="r1"></b>
					</b>
				</div>
</app:view>

</body>
</html>
