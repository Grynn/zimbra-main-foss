# __ISync

evolution: CUR_DEST_ROOT := $(EVO_DEST_ROOT) 
evolution: CUR_PACKAGE_NAME := zimbra-evolution
evolution: CUR_PACKAGE_SPEC := $(BUILD_ROOT)/evolution-zimbra.spec
evolution: CUR_PACKAGING_OPTIONS := $(EVO_PACKAGING_OPTIONS)
evolution: $(PACKAGE_DIR) evolution_stage evolution_pkg_spec_$(PACKAGE_EXT)
						(cd $(CUR_DEST_ROOT); \
							$(PACKAGING_COMMAND) $(PACKAGING_OPTIONS) )

evolution_pkg_spec_ccs:

evolution_pkg_spec_pkg:

evolution_pkg_spec_rpm: $(CUR_PACKAGE_SPEC)

evolution_pkg_spec_deb: $(EVO_DEST_ROOT)/DEBIAN/control

evolution_pkg_spec_tgz: 

evolution_stage: $(EVO_COMPONENTS)

$(EVO_DEST_DIR):
	@echo "*** Creating Evolution Connector"
	mkdir -p $@
	(cd $(EVO_DIR); sh ./bootstrap.sh)
	(env DESTDIR=$(EVO_DEST_DIR) make -e install)

# 
# Debian specific 
#
$(EVO_DEST_ROOT)/DEBIAN: force
	mkdir -p $@
	chmod -R 555 $@

$(EVO_DEST_ROOT)/DEBIAN/control: $(EVO_DEST_ROOT)/DEBIAN force
	cat $(PACKAGE_CONF_DIR)/Spec/evolution-zimbra.deb | \
	sed -e 's/@@VERSION@@/$(VERSION_TAG)/' \
	-e 's/@@RELEASE@@/$(RELEASE)/' \
	-e 's/@@ARCH@@/$(ARCH)/' > $@

#
# RPM 
#
$(CUR_PACKAGE_SPEC):
	cat $(PACKAGE_CONF_DIR)/Spec/evolution-zimbra.spec | \
	sed -e 's/@@VERSION@@/$(VERSION_TAG)/' \
	-e 's/@@RELEASE@@/$(RELEASE)/' \
	-e 's/@@ARCH@@/$(ARCH)/' > $@

#
# TGZ
#

